<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LocalFresh - Checkout</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family:'Poppins',sans-serif; }
  body { background:#f4f7f6; color:#333; }
  header { background: linear-gradient(90deg, #56ab2f, #a8e063); color:white; padding:20px; text-align:center; }
  main { max-width:800px; margin:40px auto; background:white; padding:30px; border-radius:15px; box-shadow:0 5px 25px rgba(0,0,0,0.1); }
  h2 { margin-bottom:20px; text-align:center; }
  .cart-summary { margin-bottom:30px; }
  .cart-summary ul { list-style:none; margin-bottom:10px; }
  .cart-summary li { display:flex; justify-content:space-between; margin-bottom:8px; }
  .details, .payment-section { margin-bottom:30px; }
  label { font-weight:600; display:block; margin-bottom:5px; }
  input, textarea, select { width:100%; padding:10px; margin-bottom:15px; border:1px solid #ccc; border-radius:8px; }
  button { background:#4CAF50; color:white; border:none; padding:12px 25px; font-weight:600; border-radius:10px; cursor:pointer; transition:0.3s; }
  button:hover { background:#45a049; }
  .success { background:#e7ffe7; border:1px solid #4CAF50; color:#333; padding:15px; border-radius:10px; text-align:center; display:none; margin-top:15px; }
</style>
</head>
<body>
  <header>
    <h1>LocalFresh Checkout</h1>
  </header>
  <main>
    <h2>Order Summary</h2>
    <div class="cart-summary">
      <ul id="order-items"></ul>
      <p><strong>Total: â‚¹<span id="total">0</span></strong></p>
    </div>

    <div class="details">
      <h3>Delivery Details</h3>
      <label for="name">Full Name</label>
      <input type="text" id="name" placeholder="Enter your name" required>
      <label for="address">Delivery Address</label>
      <textarea id="address" rows="3" placeholder="Enter your address" required></textarea>
      <label for="phone">Phone Number</label>
      <input type="tel" id="phone" placeholder="Enter your phone number" required>
    </div>

    <div class="payment-section">
      <h3>Payment Method</h3>
      <label for="payment-select">Choose Payment Method</label>
      <select id="payment-select">
        <option value="">-- Select --</option>
        <option value="upi">ðŸ“± UPI</option>
        <option value="card">ðŸ’³ Credit/Debit Card</option>
        <option value="cod">ðŸ’µ Cash on Delivery</option>
      </select>
    </div>

    <button onclick="proceedPayment()">Proceed to Payment</button>
    <div class="success" id="success">âœ… Order placed successfully! Thank you for shopping with LocalFresh.</div>
  </main>

<!-- Razorpay Checkout script -->
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script>
  const cart = JSON.parse(localStorage.getItem('cart')) || [];
  const orderList = document.getElementById('order-items');
  const totalDisplay = document.getElementById('total');
  const paymentSelect = document.getElementById('payment-select');
  const successMsg = document.getElementById('success');

  function renderOrder(){
    let total = 0;
    orderList.innerHTML = '';
    cart.forEach(item => {
      const li = document.createElement('li');
      li.innerHTML = `<span>${item.name}</span><span>â‚¹${item.price}</span>`;
      orderList.appendChild(li);
      total += item.price;
    });
    totalDisplay.textContent = total;
  }

  function proceedPayment(){
    const payment = paymentSelect.value;
    const name = document.getElementById('name').value.trim();
    const address = document.getElementById('address').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const totalAmount = cart.reduce((sum, item) => sum + item.price, 0) * 100; // in paise

    if(!name || !address || !phone){
      alert('Please fill all delivery details before proceeding.');
      return;
    }
    if(!payment){
      alert('Please select a payment method.');
      return;
    }

    if(payment === 'cod'){
      successMsg.style.display = 'block';
      localStorage.removeItem('cart');
      orderList.innerHTML = '';
      totalDisplay.textContent = '0';
      return;
    }

    // Razorpay test checkout
    const options = {
      key: 'rzp_test_YourKeyHere', // Replace with your Razorpay Test Key ID
      amount: totalAmount,
      currency: 'INR',
      name: 'LocalFresh',
      description: 'Order Payment',
      image: 'https://example.com/logo.png', // Optional
      handler: function(response){
        alert('Payment successful! Payment ID: ' + response.razorpay_payment_id);
        successMsg.style.display = 'block';
        localStorage.removeItem('cart');
        orderList.innerHTML = '';
        totalDisplay.textContent = '0';
      },
      prefill: {
        name: name,
        email: 'customer@example.com',
        contact: phone
      },
      notes: { address: address },
      theme: { color: '#56ab2f' }
    };

    const rzp = new Razorpay(options);
    rzp.open();
  }

  renderOrder();
</script>
</body>
</html>
